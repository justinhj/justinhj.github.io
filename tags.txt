;; -*- mode: emacs-lisp; flycheck-disabled-checkers:emacs-lisp-checkdoc -*-
;; Create tag files

(defun flatten (list-of-lists)
  (apply #'append list-of-lists))

(setq my-tags
      (-distinct
       (flatten '(
                  (c++ astar-algorithm game-programming gamedev bugs)
                  (emacs command-line mac)
                  (clojure)
                  (linux cygwin)
                  (clojure)
                  (scala functional-programming zio hacker-news-api)
                  (emacs emacs-lisp)
                  (emacs dired emacs-lisp)
                  (mp3 flac)
                  (emacs)
                  (emacs windows)
                  (game-dev clojure common-lisp f-sharp)
                  (emacs redis eredis emacs-lisp)
                  (mysql python)
                  (wget)
                  (scala functional-programming hacker-news hacker-news-api fetch typelevel reftree scala.js 47-degs)
                  (emacs growl mac)
                  (emacs)
                  (find command-line mac)
                  (scala functional-programming hacker-news-api fetch typelevel 47-degs)
                  (latex)
                  (mysql)
                  (emacs functional-programming redis emacs-lisp)
                  (scala monads functional-programming scalaz monad-transformers)
                  (emacs smtp windows win32)
                  (command-line)
                  (emacs visual-studio)
                  (rss emacs xml parsing bbc-news emacs-lisp)
                  (c c++ elisp)
                  (cygwin win32)
                  (emacs emacs-lisp)
                  (emacs growl)
                  (emacs windows win32)
                  (emacs emacs-lisp)
                  (emacs emacs-lisp perforce p4)
                  (emacs p4 perforce emacs-lisp)
                  (ubuntu)
                  (emacs tags win32 etags emacs cygwin)
                  (geek stack-overflow)
                  (game-development ai)
                  (emacs org-mode blogging github-pages jekyll)
                  (emacs)
                  (msdos command-line)
                  (mac command-line emacs)
                  (screen linux)
                  (emacs)
                  (emacs c++)
                  (msdos win32 command-line)
                  (svn google-code sourceforge source-control)
                  (find)
                  (c c++)
                  (emacs-lisp)
                  (personal-finance emacs emacs-lisp)
                  (scala functional-programming hacker-news-api fetch 47-degs typelevel monix)
                  (clojure)
                  (msdos win32 command-line batch-files)
                  (scala monads eithert functional-programming cats monad-transformers)
                  (emacs smtp)
                  (emacs functional-programming radix-trees company-mode data-structures)
                  (cygwin secure-file-transfer scp)
                  (lisp common-lisp)
                  (log4j backend-dev)
                  (msdos windows command-line win32)
                  (scala functional-programming hacker-news-api)
                  (emacs c++)
                  (emacs)
                  ( command-line )
                  (emacs)
                  (c++ gamedev a-star-algorithm)
                  (mingw32)
                  (emacs dired emacs-lisp)
                  (tar gzip linux bash)
                  (emacs dired)
                  (scala functional-programming)
                  (emacs lispworks slime win32)
                  (ubuntu linux ssh fail2ban)
                  (emacs redis)
                  (vancouver gamedev)
                  (common-lisp)
                  (emacs web-jump)
                  (scala functional-programming comonads pure-functional-programming typelevel cats)
                  (c c++)
                  (email emacs emacs-lisp)
                  (blogging emacs python)
                  (ipin transmission)
                  (mysql)
                  (scala functional-programming monoids pure-functional-programming scalaz typelevel cats)
                  (mac r)
                  (emacs)
                  (scala functional-programming zio hacker-news-api 47-degs fetch)
                  (command-line)
                  (scala scala.js clojure-script functional-programming udash)
                  ))))

(dolist (tag my-tags)
  (insert (format "%s %s\n" (symbol-name tag) (type-of (symbol-name tag)))))

;; Given a tag which is in snakecase, make it prettier
(defun humanise-tag(tag)
  (capitalize
   (replace-regexp-in-string "-" " " tag)))

;; Given a tag open the file
(defun process-tag(tag)
  "Create a the markdown for this TAG."
  (let* ((tag-str (symbol-name tag))
         (fpath (concat "./_my_tags/" tag-str ".md")))
    ;; create temp buffer without undo record or font lock. (more efficient)
    ;; first space in temp buff name is necessary
    (with-temp-buffer
      (unless (file-exists-p fpath)
        (insert "---\nlayout: blog_by_tag\n")
        (insert (format "slug: %s\n" tag-str))
        (insert (format "name: %s\n" (humanise-tag tag-str)))
        (insert "---\n")
        (write-file fpath)))))

(dolist (tag my-tags)
  (process-tag tag))
