---
layout: post
title: 11 Visual Studio tricks in Emacs
date: '2007-09-27T14:46:00.000-07:00'
author: Justin
tags: [emacs, visual-studio]
modified_time: '2007-09-27T14:50:25.612-07:00'
blogger_id: tag:blogger.com,1999:blog-4777243148323391813.post-2741852211389762610
blogger_orig_url: http://justinsboringpage.blogspot.com/2007/09/11-visual-studio-tricks-in-emacs.html
---

Recently I read the blog post <a href="http://www.chinhdo.com/chinh/blog/20070920/top-11-visual-studio-2005-ide-tips-and-tricks-to-make-you-a-more-productive-developer/">"11 Visual Studio 2005 IDE Tips and Tricks to Make You a More Productive Developer"</a> which has some neat tips indeed. I thought I would investigate which of the tips can be replicated in emacs, which are easier or more powerful in emacs and vice versa.<br /><br />I've been using Visual Studio for over 10 years though I'm certainly not a power user, and recently I only use it for building and occasional code editing. I do more editing in emacs. I'm not writing this post to prove that one is better than the other, it is more for the learning experience for myself, and hopefully somebody will find something interesting here.<br /><br />(1) Express Yourself with Regular Expressions<br /><br />The example is to convert<br /><br />    , last_name<br />    , ssn<br />    , employee_id<br /><br />into<br /><br />    + "last_name"<br />    + "ssn"<br />    + "employee_id"<br /><br />using a regex. Well, I'd probably record a keyboard macro to do that, but let's do the regex replace instead.<br /><br />The syntax of the regex is a little different in emacs, but the basic sequence looks like this:<br /><br />Alt-x replace-regexp<br />\(, \)\(.*$\)<br />, "\2"<br /><br />Notice you need slashes for the brackets to make the groups.<br /><br />Verdict: Visual Studio lets you use Regex's in script, and emacs lets you do it in elisp code... and they both have the functionality needed for the tip. Draw.<br /><br />(2) Take (Keyboard) Shortcuts<br /><br />This tip is to simply use keyboard shortcuts. Well in fact you won't get anywhere with emacs without using them. So this is kind of a mute point.<br /><br />But I'll list some random keyboard short cuts for completeness...<br /><br />Alt z runs zap-to-char, kills everything up until the character you enter.<br /><br />Alt . runs find-tag. Finds the next occurence of current tag in the tags table, for finding function and variable declarations for example.<br /><br />Ctrl U Alt . finds previous tag<br /><br />Ctrl < goes to the start of a buffer<br /><br />Ctrl > goes to the end<br /><br />Ctrl H m describes the current mode, which is handy if you just downloaded a new editing mode and you want to see what the keys are and so on<br /><br />Alt t runs transpose. You can flip two words around.<br /><br />Verdict: Another draw.<br /><br />(3) Make New Shortcuts<br /><br />This is straight forward in emacs...<br /><br />(global-set-key [M-f2] 'zap-to-char)<br /><br />... sets Alt-F2 to do zap-to-char<br /><br />You can override keys globally like that, or you can do local-set-key to change that key only for the current editing mode.<br /><br />Verdict: emacs and Visual Studio both allow remapping anything they can do to a key, and they both allow you to redefine a key differently for different modes. Another draw!<br /><br />(4) Use Code Snippets<br /><br />I wasn't aware of this feature for Visual Studio so I checked it out briefly. So it lets you dump out text, such as automatically creating empty for loops or adding set and get fields given a field name.<br /><br />Well in emacs there are abbreviations. So for example let's say I want for( to automatically expand to for(int i; i<???; i++)<br />then I can make an abreviation, by going into the mode I want this to be active, and typing<br /><br />Alt-x abbrev-mode (turn the mode on)<br />Alt-X define-mode-abbrev (interactively add a new abbreviation for this mode)<br />for<br />for(int i; i<???; i++)<br /><br />and now when I type for and space, it will expand automatically.<br /><br />If you don't want it to expand then you type Ctrl-Q before you complete the abbreviation.<br /><br />But snippets let you do more advanced stuff like take a field name and create the get, set fields. Well I would write elisp code for that kind of thing, or again use a keyboard macro.<br /><br />Abbreviations are nice and easy to use, but they don't have the power of snippets.<br /><br />Verdict: Visual Studio code snippets don't seem to map directly to emacs. In emacs you can use the more basic abbreviations, or roll your own solution for wrapping text in more dynamic ways.<br /><br />(5) State Your Preferences<br /><br />Not a lot to say here. emacs is fully configurable through the startup file .emacs, so you can do configure everything as you want it to be.<br /><br />Verdict: Draw.<br /><br />(6) "Attach to Process" to Start Debugging ASP.NET<br /><br />Emacs doesn't support windows debugging, of course, but you can use gdb to debug processes. So the same functionality would be :<br /><br />Alt-x gdb<br />attach [process ID]<br /><br />Verdict: Draw.<br /><br />7) Stop Conditionally (Conditional Breakpoints)<br /><br />Again, this is a windows only thing... you can run gdb and type<br /><br />break [LOCATION]<br /><br />and<br /><br />condition [COND]<br /><br />to set up a conditional breakpoint.<br /><br />Verdict: Draw. You can't debug windows processes from emacs, and you can't debug linux processes from Windows, but both offer debugging from within the IDE.<br /><br />(8) Employ Task List Tokens<br /><br />This is an odd feature. By typing // TODO in C++ code, for example, you can view the TODO's in a task list window for that file.<br /><br />Emacs lets you do this with say the 'occur' function.<br /><br />Alt-X occur<br />TODO<br /><br />Will give a list of lines containing TODO.<br /><br />You could make an elisp function to wrap this up into a task list function:<br /><br />(defun task-list()<br />       (interactive)   <br />       (occur "TODO"))   <br /><br />Verdict: Not much of a feature really, but yeah, another draw.<br /><br />(9)  Go Directly to Any File with the Find Combo Box<br /><br />I couldn't get this tip to work, but Alt-Shift O seems to be the one he is talking about. A very nice list of files, and you can quickly open a file by typing part of the filename.<br /><br />emacs doesn't include the files in your current project, so we don't have a direct comparison, but let's assume you have a root directory containing your source and you want to find files matching a regex:<br /><br />Alt-x find-dired<br />d:\YourSourceFiles\<br />-regex ".*SEARCHTEXT.*"<br /><br />This will open a dired window (like a file manager dialog box but lets you do lots more things to the files) containing the matching files.<br /><br />Verdict: emacs is a bit better than studio in that you can search using all the power of the unix find command, but it's more fiddly to use, and there's no equivalent to Studio managing all the files in each project. (That I know of).<br /><br />(10) Type Ahead (Incremental Search) in Lists<br /><br />So for example in Studio, do Ctrl-O and you get a file dialog. Typing letters gradually filters the available files until you get the one you want.<br /><br />Emacs has exactly the same thing.<br /><br />Ctrl-X Ctrl-F to visit a file for example (although this works with anything that asks you for a file.)<br /><br />Firstly you can use the buffer history to find files you opened and closed earlier, and also you can edit this, so if you just opened a .cpp file, you can change it to .h and load that easily.<br /><br />Secondly hitting tab will cycle through possible files based on what you typed so far, but also open a buffer with the current valid files, so you can switch and select from there.<br /><br />Finally, if you open the wrong file by mistake you can run 'find-alternate-file' and load a different file into the buffer you opened.<br /><br />Verdict: emacs wins by a nose. More flexibility.<br /><br />(11) Automate with Macros and Visual Studio Automation<br /><br />emacs also has very cool macro recording...<br /><br />Ctrl-X (   starts recording<br /><br />do your thing<br /><br />Ctrl-X )   ends recording<br /><br />Ctrl-X e   runs the macro<br /><br />If you make a useful macro that runs on one line, you can then run it multiple times:<br /><br />Ctrl-U 10 Ctrl-X e<br /><br />runs the macro 10 times for example.<br /><br />You can also edit the macro with edit-last-kbd-macro, which brings up an editor.<br /><br />Well that's it, I'm sure I've missed out a lot of emacs features, I've been using it for about 4 years and I know there is still a lot of stuff in there I haven't discovered!
