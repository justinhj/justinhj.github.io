---
layout: post
title: Adding C++ class names to a function name
date: '2007-09-11T08:44:00.000-07:00'
author: Justin
tags: [c, c++, elisp]
modified_time: '2007-09-11T11:46:13.380-07:00'
blogger_id: tag:blogger.com,1999:blog-4777243148323391813.post-8898140909915618671
blogger_orig_url: http://justinsboringpage.blogspot.com/2007/09/adding-c-class-names-to-function-name.html
---

I use this elisp code to add a C++ class name to a line such as:<br /><pre><br />void getNameRawString(char *string);<br /><br />automatically becomes ...<br /><br />void SomeClassName::getNameRawString(char *string);<br /></pre><br /><br />This is useful as you can copy a bunch of class method definitions from a header file you've just created and then run this on each line to add the class names. <br /><br />First I wrote a utility function that finds the function name, which is presumed to be letters and underscores, following space and ended with a bracket. The function name includes the word probably because it might not work depending on your formatting, but you can twiddle the regex to get what you want. <br /><br />So as you can see this finds the match for the regex, which will place the point at the end of the search. Then I search backwards for a space which puts the point where we want to insert the class name and double colons...<br /><br /><pre><br />(defun find-function-start-probably()<br />  (interactive)<br />  (re-search-forward " [*&_a-zA-Z]+(")<br />  (re-search-backward " ")<br />  (forward-char)<br />  (if (or<br />       (char-equal (char-after) ?*)<br />       (char-equal (char-after) ?&))<br />      (forward-char)))<br /></pre><br /><br />Finally the function below calls find-function-start-probably. It prompts for the class name, finds the function and inserts the text. The program automatically aborts if there is no match. You can override that behavior by passing arguments to re-search-forward.<br /><br /><pre><br />(defun classname-add(classname)                                                                   <br />    (interactive "sEnter class name: ")                                                           <br />    (find-function-start-probably)                                                                <br />    (insert classname)                                                                            <br />    (insert "::")                                                                                 <br />    (beginning-of-line)                                                                           <br />    (forward-line)) <br /></pre><br /><br />Improvements on the way:<br /><br />Multi-line version: do this over multiple lines<br /><br />Improvements unlikely but would be nice:<br /><br />Parse the header file more intelligently and create all the class function definitions with empty function bodies in a specified buffer
